<!DOCTYPE html>
<html>
    <head><title>TicTacToe</title></head>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
    <script>
        var areaSize = 3;
        var turn = 1;
        var winner=0;
        var access=1;
        
        var area = [0.1,0.1,0.1, 0.1,0.1,0.1, 0.1,0.1,0.1]; // [0,1,2,  3,4,5,  6,7,8]
        

        $(document).ready(function(){
        $('td').hover(function(){
            if(turn%2!=0){  $(this).css({"background-color":"rgba(0,255,255,0.1)"}); }
            else {$(this).css({"background-color":"rgba(255,0,255,0.1)"});}
          
        });
        $('td').click(function(){
            if($(this).text()!="O" && $(this).text()!="X" && access==1){
                var Index = $(this).attr('id').substr(1)-1;

                
                if(turn%2!=0){ $(this).text("X"); area[Index]=2; }
                else { $(this).text("O"); area[Index]=1; }
                turn++;
                check();
                
                 
            }
            else if(access==0){reset(); access=1;}
            
        });
        $('td').mouseout(function(){
            $(this).css({"background-color":"white"});
        });
        });
        function check(){

            var buffer=0;
            if(turn<areaSize*3){
                
                for(var x=1; x<area.length+1; x++){
                    var bufferVertical=0;
                    var bufferDiagonal=0;
                    
                    if(x<=areaSize)
                    {
                        // vertical - first n (n - size of area, by default 3) elements of the array (0,1,2) increase n times by n - 0, 3, 6; 1, 4, 7;
                        // 0,1,2 -> 0,3,6 ; 1,4,7 ; 2, 5, 8
                        for(var a=0; a<areaSize; a++){bufferVertical+=area[x-1+a*3]; /*console.log("\n\ntest: " + test + " x-1+a*3: " +(x-1+a*3)+" area[x-1+a*3]: "+area[x-1+a*3]);*/}
                        if(bufferVertical==6||bufferVertical==3){access=0; console.log("Winner vertical"); reset();}    

                        // diagonal - first element of the array (0) increase n times by n+1 (0,4,8) and n element of the array (2) increase n times by n-1 (2,4,6)
                        // (0) increase n times by n+1 (0,5,10,15) and n element of the array (3) increase n times by n-1 (3,6,9,12)
                        if(x==1){var helpV = areaSize+1;}
                        else if(x==areaSize){var helpV = areaSize-1;}
                            
                        for(var h=0; h<areaSize; h++){bufferDiagonal+=area[x-1+h*helpV]; /*console.log("\n\ntestD: " + testD + " x-1+h*helpV: " +(x-1+h*helpV)+" area[x-1+h*helpV]: "+area[x-1+h*helpV]);*/}
                        if(bufferDiagonal==6||bufferDiagonal==3){access=0; console.log("Winner diagonal"); reset();}
                        
                        
                    }

                    // horizontal part
                    buffer+=area[x-1];
                    if(x%areaSize==0)
                    {
                        if(buffer==3){ winner=1; console.log("winner horizontal: " + winner); reset();}
                        else if(buffer==6){ winner=2; console.log("winner horizontal: " + winner); reset();}
                        buffer=0;
                    }
                }
                
            }
            else {
                access=0;
            }


        }
        function reset(){
            turn=1;
            $(document).ready(function(){
                $('td').each(function(){
                    $(this).text("");
                })
                $('p#result').text("");
            });
            area=[0.1,0.1,0.1, 0.1,0.1,0.1, 0.1,0.1,0.1];
            winner=0;
            access=1;
        }
        function showUp(){
            // for(var x=1; x<area.length+1; x++){
            //     console.log(area[x-1]);
            //     if(x%3==0){console.log("\n\n");}
            // }
        console.log(" " + area[0] + " | " + area[1] + " | " + area[2] + " \n");
        console.log("-----------\n");
        console.log(" "<< area[3] <<" | "<< area[4] <<" | "<< area[5]<<" \n");
        console.log("-----------\n");
        console.log(" "<< area[6] <<" | "<< area[7] <<" | "<< area[8]<<" \n");
        }
        

    </script>
    <style>
        * {margin:0; padding:0; border-spacing: 1;}
        body,html {width:100%; height:100%; overflow-x: hidden; overflow-y: hidden; }
        div.wrapper {display:flex; flex-direction: row; width:100%; height:100%; }
        div.left {width:50%; height:100%; margin-left:10px;margin-top:5px;}
        div.right {width:50%; height:100%; display:flex; justify-content:start; align-items: center; font-size:30px; color:red;}
        table {
            text-align: center;
            border-bottom:1px solid black;
            border-left:1px solid black;
            border-style: none;
            width:500px;
            height:600px;
            font-size:40px;
            margin-bottom:5px;
            
        }

        td {
            border:1px solid black;
            width:40px;
            height:40px;
        }
    </style>
    <body>
        <div class="wrapper">
            <div class="left">
                <p style="margin-bottom:0;">TicTacToe</p>
                <table>
                    <tr id="r1">
                        <td id="t1"></td>
                        <td id="t2"></td>
                        <td id="t3"></td>
                    </tr>
                    <tr id="r2">
                        <td id="t4"></td>
                        <td id="t5"></td>
                        <td id="t6"></td>
                    </tr>
                    <tr id="r3">
                        <td id="t7"></td>
                        <td id="t8"></td>
                        <td id="t9"></td>
                    </tr>
                </table>
                <button onclick="reset()">Reset!</button>
                <button onclick="showUp()">Show</button>
            </div>
            <div class="right"><p id="result" style="text-align: center;">1</p></div>
        </div>
        
        

        
        
    </body>
</html>
